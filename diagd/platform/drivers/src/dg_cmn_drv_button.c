/*==================================================================================================

    Module Name:  dg_cmn_drv_button.c

    General Description: Implements the BUTTON common driver

====================================================================================================

====================================================================================================
                                           INCLUDE FILES
==================================================================================================*/
#include <unistd.h>
#include "dg_handler_inc.h"
#include "dg_drv_util.h"
#include "dg_cmn_drv_button.h"


/** @addtogroup dg_common_drivers
@{
*/

/** @addtogroup BUTTON_driver
@{
implementation of the BUTTON driver
*/

/*==================================================================================================
                                          LOCAL CONSTANTS
==================================================================================================*/

/*==================================================================================================
                                           LOCAL MACROS
==================================================================================================*/

/*==================================================================================================
                            LOCAL TYPEDEFS (STRUCTURES, UNIONS, ENUMS)
==================================================================================================*/

/*==================================================================================================
                                     LOCAL FUNCTION PROTOTYPES
==================================================================================================*/

/*==================================================================================================
                                         GLOBAL VARIABLES
==================================================================================================*/

/*==================================================================================================
                                          LOCAL VARIABLES
==================================================================================================*/

/*==================================================================================================
                                         GLOBAL FUNCTIONS
==================================================================================================*/

/*=============================================================================================*//**
@brief Reads data from a given address on the given BUTTON bus

@param[out] code - The last pressed button key code

*//*==============================================================================================*/
BOOL DG_CMN_DRV_BUTTON_get(DG_CMN_DRV_BUTTON_CODE_T* code)
{
    static DG_CMN_DRV_BUTTON_CODE_T key_code = DG_CMN_DRV_BUTTON_NONE;

    if (key_code == DG_CMN_DRV_BUTTON_NONE)
    {
        sleep(3); /* simulate the process to wait for a button press */
        key_code = DG_CMN_DRV_BUTTON_POWER;
    }
    else
    {
        key_code = DG_CMN_DRV_BUTTON_NONE;
    }

    DG_DBG_TRACE("the last button key_code=0x%02x", key_code);

    *code = key_code;

    return TRUE;
}

/*==================================================================================================
                                          LOCAL FUNCTIONS
==================================================================================================*/

/** @} */
/** @} */

