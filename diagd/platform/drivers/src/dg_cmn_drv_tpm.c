/*==================================================================================================

    Module Name:  dg_cmn_drv_tpm.c

    General Description: Implements the TPM common driver

====================================================================================================

====================================================================================================
                                           INCLUDE FILES
==================================================================================================*/
#include "dg_handler_inc.h"
#include "dg_drv_util.h"
#include "dg_cmn_drv_tpm.h"


/** @addtogroup dg_common_drivers
@{
*/

/** @addtogroup TPM_driver
@{
implementation of the TPM driver
*/

/*==================================================================================================
                                          LOCAL CONSTANTS
==================================================================================================*/

/*==================================================================================================
                                           LOCAL MACROS
==================================================================================================*/

/*==================================================================================================
                            LOCAL TYPEDEFS (STRUCTURES, UNIONS, ENUMS)
==================================================================================================*/

/*==================================================================================================
                                     LOCAL FUNCTION PROTOTYPES
==================================================================================================*/

/*==================================================================================================
                                         GLOBAL VARIABLES
==================================================================================================*/

/*==================================================================================================
                                          LOCAL VARIABLES
==================================================================================================*/

/*==================================================================================================
                                         GLOBAL FUNCTIONS
==================================================================================================*/

/*=============================================================================================*//**
@brief Get capability from TPM device

@param[out] tpm - The tpm capability read from the device
*//*==============================================================================================*/
BOOL DG_CMN_DRV_TPM_get_capability(DG_CMN_DRV_TPM_CAPABILITY_T* tpm)
{
    tpm->tag               = 0x1111;
    tpm->version           = 0x22222222;
    tpm->specLevel         = 0x3333;
    tpm->errataRev         = 0x44;
    tpm->tpmVendorID       = 0x55555555;
    tpm->venorSpecificSize = 0x6666;
    memset(tpm->buildNumber, 0x77, sizeof(tpm->buildNumber));
    DG_DBG_TRACE("Get TPM capability.");

    return TRUE;
}

/*=============================================================================================*//**
@brief Get self test result from TPM device

@param[out] result - The TPM self test result read from the device
*//*==============================================================================================*/
BOOL DG_CMN_DRV_TPM_get_test_result(DG_CMN_DRV_TPM_TEST_RESULT_T* result)
{
    *result = 0x11111111;
    DG_DBG_TRACE("Get TPM selftest result 0x%02x.", *result);

    return TRUE;
}

/*=============================================================================================*//**
@brief Get PCR value from TPM device

@param[in]  offset - PCR offset
@param[out] pcr    - The TPM PCR value read from the device
*//*==============================================================================================*/
BOOL DG_CMN_DRV_TPM_get_pcr(DG_CMN_DRV_TPM_OFFSET_T offset, DG_CMN_DRV_TPM_PCR_T* pcr)
{
    *pcr = 0x100 + offset;
    DG_DBG_TRACE("Get TPM PCR 0x%02x.", *pcr);

    return TRUE;
}

/*=============================================================================================*//**
@brief Get counter from TPM device

@param[in]  offset  - counter offset
@param[out] counter - The TPM counter read from the device
*//*==============================================================================================*/
BOOL DG_CMN_DRV_TPM_get_counter(DG_CMN_DRV_TPM_OFFSET_T offset, DG_CMN_DRV_TPM_COUNTER_T* counter)
{
    *counter = 0x200 + offset;
    DG_DBG_TRACE("Get TPM counter 0x%02x.", *counter);

    return TRUE;
}

/*==================================================================================================
                                          LOCAL FUNCTIONS
==================================================================================================*/

/** @} */
/** @} */

